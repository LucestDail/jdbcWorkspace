<%@page import="model.Member"%>
<%@page import="model.MemberDao"%>
<%@ page language="java" contentType="text/html; charset=EUC-KR"
    pageEncoding="EUC-KR"%>
<!DOCTYPE html>
<%-- 
1. 모든 파라매터 정보를 Member 객체에 저장 => useBean 태그
2. 입력된 비밀번호와 데이터베이스에 저장된 비밀번호 비교
-> 같지 않은 경우 : "비밀번호 오류" 메시지 출력, updateForm.jsp 페이지 이동
3. 파라매터를 저장하고 있는 Member 객체를 이용하여 데이터베이스 정보 수정
int MemberDao.update(Member)
결과가 0 이하면 수정실패 메시지 출력후 updateForm.jsp 페이지 이동
1 이상이면 수정 성공 => info.jsp 페이지로 이동
 --%>
<html>
<head>
<meta charset="EUC-KR">
<title>Insert title here</title>
</head>
<body>
<%request.setCharacterEncoding("euc-kr");%>
<jsp:useBean id = "mem" class = "model.Member"/>
<%-- 파라매터와 Member 객체의 프로퍼티가 같은 경우(property="*") setProperty 를 이용, Member 객체에 파라매터 저장 --%>
<jsp:setProperty property = "*" name = "mem"/>
<%
String sessionId = (String)session.getAttribute("id");
MemberDao dao = new MemberDao();
Member curDao = new MemberDao().selectOne(sessionId);


//dao.update 통하여 성공하면 양수, 실패시 0, 음수 반환
int result = dao.update(mem);
String msg = "비밀번호 오류 실패";
String url = "updateForm.jsp";
if(result > 0){
	msg = mem.getName() + "님 회원정보 수정 완료";
	url = "info.jsp";
}
%>
<script>
	alert("<%=msg%>");
	location.href = "<%=url%>";

</script>
</body>
</html>